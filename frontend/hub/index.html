<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resolution Hub | PuppyPad</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700&display=swap" rel="stylesheet">
  <!-- Satoshi and Space Grotesk fonts for brand aesthetics -->
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <!-- Hub Styles -->
  <link href="/hub/hub-styles.css" rel="stylesheet">
  <style>
    :root {
      --brand-navy: #1a365d;
      --brand-navy-light: #2c5282;
      --accent-teal: #4fd1c5;
      --accent-coral: #f56565;
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-300: #d1d5db;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --gray-900: #111827;
      --success: #10b981;
      --warning: #f59e0b;
      --error: #ef4444;
      --info: #3b82f6;
      --sidebar-width: 240px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Satoshi', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #FFF8E7 0%, #FFF5F5 50%, #F0F7FF 100%);
      background-attachment: fixed;
      color: var(--gray-800);
      min-height: 100vh;
    }

    /* Login Screen */
    #loginScreen {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #FFF8E7 0%, #FFF5F5 50%, #F0F7FF 100%);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .login-container {
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 48px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15), 
                  0 0 0 1px rgba(255, 255, 255, 0.6),
                  inset 0 1px 0 rgba(255, 255, 255, 0.5);
      width: 100%;
      max-width: 420px;
      animation: slideUpCard 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
      position: relative;
      z-index: 10;
    }
    
    @keyframes slideUpCard {
      from {
        opacity: 0;
        transform: translateY(24px) scale(0.98);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .login-header {
      text-align: center;
      margin-bottom: 32px;
    }

    .login-header img {
      height: 40px;
      margin-bottom: 16px;
    }

    .login-header h1 {
      font-family: 'Space Grotesk', 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: var(--gray-900);
      margin-bottom: 8px;
    }

    .login-header p {
      color: var(--gray-500);
      font-size: 14px;
    }

    .login-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-group label {
      font-size: 14px;
      font-weight: 500;
      color: var(--gray-700);
    }

    .form-group input {
      padding: 12px 16px;
      border: 1px solid var(--gray-200);
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.2s;
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--brand-navy);
      box-shadow: 0 0 0 3px rgba(26, 54, 93, 0.1);
    }

    .login-error {
      display: none;
      padding: 12px;
      background: #fee2e2;
      color: #dc2626;
      border-radius: 8px;
      font-size: 14px;
      text-align: center;
    }

    .login-btn {
      width: 100%;
      padding: 14px;
      background: var(--brand-navy);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .login-btn:hover {
      background: var(--brand-navy-light);
    }

    .login-btn:active {
      transform: scale(0.98);
    }

    /* Layout */
    .app-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: #0f172a;
      color: white;
      position: fixed;
      top: 0;
      left: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      z-index: 100;
    }

    .sidebar-header {
      padding: 20px 16px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .sidebar-logo img {
      height: 24px;
      filter: brightness(0) invert(1);
    }

    .sidebar-logo span {
      font-family: 'Space Grotesk', 'Poppins', sans-serif;
      font-size: 15px;
      font-weight: 600;
    }

    .sidebar-nav {
      flex: 1;
      padding: 16px 0;
      overflow-y: auto;
    }

    .nav-section {
      margin-bottom: 24px;
    }

    .nav-section-title {
      padding: 8px 16px;
      margin-bottom: 8px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #64748b;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 16px;
      color: #94a3b8;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      width: 100%;
      border: none;
      background: none;
    }

    .nav-item:hover {
      background: #1e293b;
      color: #e2e8f0;
    }

    .nav-item.active {
      background: #1a365d;
      color: white;
    }

    .nav-item svg {
      width: 18px;
      height: 18px;
      flex-shrink: 0;
      opacity: 0.7;
    }

    .nav-item.active svg {
      opacity: 1;
    }

    .nav-item .badge {
      margin-left: auto;
      background: #2c5282;
      color: white;
      font-size: 11px;
      font-weight: 600;
      padding: 2px 8px;
      border-radius: 10px;
      min-width: 20px;
      text-align: center;
    }

    .nav-item.active .badge {
      background: rgba(255,255,255,0.2);
      color: white;
    }

    .nav-item .badge.urgent {
      background: #ef4444;
      color: white;
    }

    .sidebar-footer {
      padding: 16px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: #2c5282;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      color: white;
      flex-shrink: 0;
    }

    .user-details {
      flex: 1;
      min-width: 0;
    }

    .user-name {
      font-size: 14px;
      font-weight: 600;
      color: white;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .user-role {
      font-size: 12px;
      color: #94a3b8;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      display: flex;
      flex-direction: column;
      position: relative;
      z-index: 2;
    }

    /* Top Header */
    .top-header {
      background: white;
      padding: 16px 32px;
      border-bottom: 1px solid var(--gray-200);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .page-title {
      font-family: 'Space Grotesk', 'Poppins', sans-serif;
      font-size: 28px;
      font-weight: 700;
      color: var(--gray-900);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .search-box {
      display: flex;
      align-items: center;
      background: white;
      border: 1px solid var(--gray-200);
      border-radius: 12px;
      padding: 10px 16px;
      gap: 8px;
      min-width: 280px;
    }

    .search-box input {
      border: none;
      background: none;
      outline: none;
      font-size: 14px;
      width: 100%;
    }

    .search-box svg {
      width: 18px;
      height: 18px;
      color: var(--gray-400);
      stroke-width: 2;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
    }

    .btn-primary {
      background: var(--brand-navy);
      color: white;
    }

    .btn-primary:hover {
      background: var(--brand-navy-light);
    }

    .btn-secondary {
      background: white;
      color: var(--gray-700);
      border: 1px solid var(--gray-200);
    }

    .btn-secondary:hover {
      background: var(--gray-50);
    }

    /* Page Content with Animated Gradient Background */
    .page-content {
      flex: 1;
      padding: 32px;
      position: relative;
      z-index: 2;
      min-height: calc(100vh - 80px);
      /* Background is now provided by animated gradient orbs */
    }

    .page-content > * {
      position: relative;
      z-index: 1;
    }

    .logout-btn:hover {
      background: #1e293b;
      color: white;
      border-color: rgba(255,255,255,0.25);
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 28px;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 16px;
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.04), 0 0 0 1px rgba(255, 255, 255, 0.5);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      animation: slideUpCard 0.4s ease-out backwards;
    }

    .stat-card:nth-child(1) { animation-delay: 0.05s; }
    .stat-card:nth-child(2) { animation-delay: 0.1s; }
    .stat-card:nth-child(3) { animation-delay: 0.15s; }
    .stat-card:nth-child(4) { animation-delay: 0.2s; }

    @keyframes slideUpCard {
      from {
        opacity: 0;
        transform: translateY(24px) scale(0.98);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .stat-card:hover {
      box-shadow: 0 20px 40px rgba(26, 54, 93, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.8);
      transform: translateY(-4px);
    }

    .stat-card.highlight {
      background: linear-gradient(135deg, var(--brand-navy) 0%, var(--brand-navy-light) 100%);
      color: white;
      border: none;
      box-shadow: 0 8px 24px rgba(26, 54, 93, 0.25);
    }

    .stat-card.highlight:hover {
      box-shadow: 0 12px 32px rgba(26, 54, 93, 0.3);
      transform: translateY(-2px);
    }

    .stat-label {
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.02em;
      color: var(--gray-500);
      margin-bottom: 8px;
    }

    .stat-card.highlight .stat-label {
      color: rgba(255, 255, 255, 0.9);
    }

    .stat-value {
      font-family: 'Space Grotesk', 'Poppins', sans-serif;
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--gray-900);
    }

    .stat-card.highlight .stat-value {
      color: white;
    }

    .stat-change {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      margin-top: 4px;
      font-weight: 500;
      color: var(--gray-500);
    }

    .stat-card.highlight .stat-change {
      color: rgba(255, 255, 255, 0.8);
    }

    .stat-change.up {
      color: var(--warning-600);
    }

    .stat-change.down {
      background: rgba(239, 68, 68, 0.1);
      color: var(--error);
    }

    /* Case Category Tabs */
    .category-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      background: white;
      padding: 8px;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }

    .category-tab {
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--gray-600);
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      background: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .category-tab:hover {
      background: var(--gray-100);
    }

    .category-tab.active {
      background: var(--brand-navy);
      color: white;
    }

    .category-tab .count {
      background: var(--gray-200);
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 12px;
    }

    .category-tab.active .count {
      background: rgba(255,255,255,0.2);
    }

    /* Cases Table - Beautiful Redesign */
    .cases-card {
      background: rgba(255, 255, 255, 0.92);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 20px;
      border: 1px solid rgba(255, 255, 255, 0.6);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(255, 255, 255, 0.5);
      overflow: hidden;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      animation: slideUpCard 0.5s ease-out backwards;
      animation-delay: 0.1s;
    }

    .cases-card:hover {
      box-shadow: 0 20px 40px rgba(26, 54, 93, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.8);
      transform: translateY(-3px);
    }

    .cases-header {
      padding: 24px 28px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(10px);
    }

    .cases-title {
      font-family: 'Space Grotesk', 'Poppins', sans-serif;
      font-size: 20px;
      font-weight: 700;
      color: var(--gray-900);
      letter-spacing: -0.02em;
    }

    .cases-filters {
      display: flex;
      gap: 12px;
    }

    .filter-select {
      padding: 8px 12px;
      border: 1px solid var(--gray-200);
      border-radius: 6px;
      font-size: 13px;
      color: var(--gray-700);
      background: white;
      cursor: pointer;
    }

    .cases-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
    }

    .cases-table th,
    .cases-table td {
      padding: 16px 20px;
      text-align: left;
    }

    .cases-table th {
      background: rgba(249, 250, 251, 0.8);
      backdrop-filter: blur(10px);
      font-size: 11px;
      font-weight: 700;
      color: var(--gray-600);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      border-bottom: 2px solid rgba(0, 0, 0, 0.06);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .cases-table tbody tr {
      cursor: pointer;
      transition: all 0.2s ease;
      background: rgba(255, 255, 255, 0.6);
      border-bottom: 1px solid rgba(0, 0, 0, 0.04);
    }

    .cases-table tbody tr:hover {
      background: rgba(255, 255, 255, 0.9);
      transform: scale(1.001);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .cases-table tbody tr:last-child td {
      border-bottom: none;
    }

    .case-id {
      font-family: 'SF Mono', 'Monaco', monospace;
      font-size: 13px;
      color: var(--brand-navy);
      font-weight: 500;
    }

    .customer-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .customer-name {
      font-weight: 600;
      color: var(--gray-900);
      font-size: 14px;
    }

    .customer-email {
      font-size: 12px;
      color: var(--gray-500);
      font-weight: 400;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.01em;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .status-badge.pending {
      background: #fef3c7;
      color: #d97706;
    }

    .status-badge.in-progress {
      background: #dbeafe;
      color: #2563eb;
    }

    .status-badge.completed {
      background: #d1fae5;
      color: #059669;
    }

    .status-badge.cancelled {
      background: #fee2e2;
      color: #dc2626;
    }

    .type-badge {
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.01em;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .type-badge.refund { background: #fee2e2; color: #dc2626; }
    .type-badge.shipping { background: #dbeafe; color: #2563eb; }
    .type-badge.subscription { background: #d1fae5; color: #059669; }
    .type-badge.return { background: #fef3c7; color: #d97706; }
    .type-badge.manual { background: #e5e7eb; color: #374151; }

    .time-ago {
      font-size: 13px;
      color: var(--gray-500);
    }

    /* Pagination */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 8px;
      padding: 20px;
      border-top: 1px solid var(--gray-100);
    }

    .pagination button {
      padding: 8px 14px;
      border: 1px solid var(--gray-200);
      background: white;
      border-radius: 6px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .pagination button:hover:not(:disabled) {
      background: var(--gray-50);
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination button.active {
      background: var(--brand-navy);
      color: white;
      border-color: var(--brand-navy);
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--gray-500);
    }

    .empty-state svg {
      width: 64px;
      height: 64px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    .empty-state h3 {
      font-size: 16px;
      color: var(--gray-700);
      margin-bottom: 8px;
    }

    /* Loading */
    .loading-spinner {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 40px;
    }

    .spinner {
      width: 32px;
      height: 32px;
      border: 3px solid var(--gray-200);
      border-top-color: var(--brand-navy);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .main-content {
        margin-left: 0;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .page-content {
        padding: 16px;
      }
    }
  </style>
</head>
<body>
  <!-- Login Screen -->
  <div id="loginScreen">
    <!-- Japanese-Style Animated Gradient Background for Login -->
    <div class="login-gradient-orbs" aria-hidden="true">
      <div class="gradient-orb login-orb"></div>
      <div class="gradient-orb login-orb"></div>
      <div class="gradient-orb login-orb"></div>
      <div class="gradient-orb login-orb"></div>
      <div class="gradient-orb login-orb"></div>
    </div>
    <div class="login-noise-overlay" aria-hidden="true"></div>
    
    <div class="login-container">
      <div class="login-header">
        <img src="https://cdn.shopify.com/s/files/1/0433/0510/7612/files/navyblue-logo.svg?v=1754231041" alt="PuppyPad">
        <h1>Resolution Hub</h1>
        <p>Sign in to access the admin dashboard</p>
      </div>
      <form class="login-form" onsubmit="handleLogin(event)">
        <div id="loginError" class="login-error"></div>
        <div class="form-group">
          <label for="loginUsername">Email</label>
          <input type="text" id="loginUsername" name="username" required autocomplete="username">
        </div>
        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" name="password" required autocomplete="current-password">
        </div>
        <button type="submit" class="login-btn">Sign In</button>
      </form>
    </div>
  </div>

  <!-- App Container -->
  <div id="appContainer" class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo">
          <img src="https://cdn.shopify.com/s/files/1/0433/0510/7612/files/navyblue-logo.svg?v=1754231041" alt="PuppyPad">
          <span>Resolution Hub</span>
        </div>
      </div>

      <nav class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Overview</div>
          <a href="/hub" class="nav-item" data-page="dashboard">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
            Dashboard
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Cases</div>
          <a href="/hub/cases" class="nav-item" data-page="cases" data-filter="all">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg>
            All Cases
            <span class="badge" id="allCasesCount">0</span>
          </a>
          <a href="/hub/cases/shipping" class="nav-item" data-page="cases" data-filter="shipping">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path></svg>
            Shipping
            <span class="badge" id="shippingCount">0</span>
          </a>
          <a href="/hub/cases/refund" class="nav-item" data-page="cases" data-filter="refund">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>
            Refunds
            <span class="badge" id="refundsCount">0</span>
          </a>
          <a href="/hub/cases/return" class="nav-item" data-page="cases" data-filter="return">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 15v-1a4 4 0 00-4-4H8m0 0l3 3m-3-3l3-3m9 14V5a2 2 0 00-2-2H6a2 2 0 00-2 2v16l4-2 4 2 4-2 4 2z"></path></svg>
            Returns
            <span class="badge" id="returnsCount">0</span>
          </a>
          <a href="/hub/cases/subscription" class="nav-item" data-page="cases" data-filter="subscription">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
            Subscriptions
            <span class="badge" id="subscriptionsCount">0</span>
          </a>
          <a href="/hub/cases/manual" class="nav-item" data-page="cases" data-filter="manual">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
            Manual Review
            <span class="badge" id="manualCount">0</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Activity</div>
          <a href="/hub/sessions" class="nav-item" data-page="sessions">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
            Sessions
          </a>
          <a href="/hub/events" class="nav-item" data-page="events">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
            Event Log
          </a>
          <a href="/hub/issues" class="nav-item" data-page="issues">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
            Issue Reports
            <span class="nav-badge" id="issuesCount">0</span>
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Analytics</div>
          <a href="/hub/analytics" class="nav-item" data-page="analytics">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
            Performance
          </a>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Resources</div>
          <a href="/hub/sop" class="nav-item" data-page="sop">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
            SOP Links
          </a>
          <a href="/hub/email-templates" class="nav-item" data-page="email-templates">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
            Email Templates
          </a>
        </div>
      </nav>

      <!-- Progress Section -->
      <div class="sidebar-progress" id="sidebarProgress">
        <div class="progress-header">
          <span class="progress-title">Today's Progress</span>
          <span class="progress-stats"><span id="progressCompleted">0</span>/<span id="progressTotal">0</span></span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar-track">
            <div class="progress-bar-fill" id="progressBarFill" style="width: 0%"></div>
          </div>
        </div>
        <div class="progress-labels">
          <span class="progress-label-pending">
            <span class="progress-dot pending"></span>
            <span id="progressPending">0</span> pending
          </span>
          <span class="progress-label-completed">
            <span class="progress-dot completed"></span>
            <span id="progressCompletedLabel">0</span> done
          </span>
        </div>
      </div>

      <div class="sidebar-footer">
          <div class="user-info">
          <div class="user-avatar">A</div>
          <div class="user-details">
            <div class="user-name">Admin</div>
            <div class="user-role">Administrator</div>
          </div>
        </div>
        <button class="logout-btn" onclick="handleLogout()" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 6px; padding: 8px 12px; border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; background: none; color: #94a3b8; font-size: 13px; cursor: pointer; transition: all 0.2s;">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" /><polyline points="16,17 21,12 16,7" /><line x1="21" y1="12" x2="9" y2="12" /></svg>
          Logout
        </button>
      </div>
    </aside>

    <!-- Japanese-Style Animated Gradient Background -->
    <div class="gradient-orbs-container" aria-hidden="true">
      <div class="gradient-orb"></div>
      <div class="gradient-orb"></div>
      <div class="gradient-orb"></div>
      <div class="gradient-orb"></div>
      <div class="gradient-orb"></div>
    </div>

    <!-- Noise Texture Overlay -->
    <div class="noise-overlay" aria-hidden="true"></div>

    <!-- Main Content -->
    <main class="main-content">
      <header class="top-header">
        <h1 class="page-title" id="pageTitle">Dashboard</h1>
        <div class="header-actions">
          <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
            <!-- Enhanced Search with Dropdown -->
            <div style="position: relative; flex: 1; min-width: 300px; max-width: 500px;">
              <div class="search-box" id="searchBoxContainer">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                <input type="text" placeholder="Search anything..." id="searchInput" autocomplete="off">
                <button id="clearSearchBtn" style="display: none; background: none; border: none; cursor: pointer; padding: 4px; color: var(--gray-400);" onclick="HubSearch.clear()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
              </div>
              <div id="searchDropdown" class="search-dropdown" style="display: none;"></div>
            </div>

            <!-- Refresh button only in header -->
            <button class="btn btn-secondary" onclick="refreshData()" style="display: flex; align-items: center; gap: 6px; padding: 10px 20px; background: white; border: 1px solid var(--gray-200); border-radius: 12px; font-size: 14px; font-weight: 600; color: var(--gray-700); cursor: pointer; transition: all 0.2s;">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16" stroke-width="2"><polyline points="23,4 23,10 17,10" /><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10" /></svg>
              Refresh
            </button>
          </div>
        </div>
      </header>

      <div class="page-content">
        <!-- Dashboard View -->
        <div id="dashboardView">
          <div class="stats-grid">
            <div class="stat-card highlight-pending">
              <div class="stat-value" id="statPending">-</div>
              <div class="stat-label">Pending Cases</div>
              <div class="stat-change urgent">Needs attention</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="statInProgress">-</div>
              <div class="stat-label">In Progress</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="statCompletedToday">-</div>
              <div class="stat-label">Completed Today</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="statAvgTime">-</div>
              <div class="stat-label">Avg. Resolution Time</div>
            </div>
          </div>

          <!-- Recent Cases -->
          <div class="cases-card cases-card-enhanced">
            <div class="cases-header">
              <h2 class="cases-title">Recent Cases</h2>
              <button class="btn btn-secondary" onclick="navigateTo('cases', 'all')">View All</button>
            </div>
            <!-- Filters above table - matching cases-filters-bar style -->
            <div class="cases-filters-bar" style="padding: 16px 20px; margin-bottom: 0; border-bottom: 1px solid var(--gray-100);">
              <div class="cases-filters-left">
                <select id="dashboardStatusFilter" class="filter-select-inline" onchange="HubDashboard.filterRecentCases()">
                  <option value="">All Status</option>
                  <option value="pending">Pending</option>
                  <option value="in_progress">In Progress</option>
                  <option value="completed">Completed</option>
                </select>
                <select id="dashboardTypeFilter" class="filter-select-inline" onchange="HubDashboard.filterRecentCases()">
                  <option value="">All Types</option>
                  <option value="refund">Refund</option>
                  <option value="shipping">Shipping</option>
                  <option value="subscription">Subscription</option>
                  <option value="return">Return</option>
                </select>
                <select id="dashboardSortFilter" class="filter-select-inline" onchange="HubDashboard.filterRecentCases()">
                  <option value="newest">Newest First</option>
                  <option value="oldest">Oldest First</option>
                </select>
              </div>
              <div class="cases-filters-right">
                <span id="dashboardResultCount" class="cases-result-count"></span>
              </div>
            </div>
            <table class="cases-table cases-table-enhanced">
              <thead>
                <tr>
                  <th style="width: 40px;"><input type="checkbox" id="dashboardSelectAll" onclick="HubDashboard.toggleSelectAll(this)"></th>
                  <th class="th-customer">CUSTOMER</th>
                  <th class="th-type">TYPE</th>
                  <th class="th-status">STATUS</th>
                  <th class="th-due">DUE</th>
                  <th class="th-resolution">RESOLUTION</th>
                  <th class="th-assignee">ASSIGNEE</th>
                  <th class="th-created">CREATED</th>
                </tr>
              </thead>
              <tbody id="recentCasesBody">
                <tr><td colspan="8" class="loading-spinner"><div class="spinner"></div></td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Cases View (will be shown/hidden) -->
        <div id="casesView" style="display: none;">
          <!-- Filters Bar Above Table -->
          <div class="cases-filters-bar">
            <div class="cases-filters-left">
              <select id="casesStatusFilter" class="filter-select-inline" onchange="HubFilters.applyFilters()">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="in_progress">In Progress</option>
                <option value="completed">Completed</option>
              </select>
              <select id="casesAssigneeFilter" class="filter-select-inline" onchange="HubFilters.applyFilters()">
                <option value="">All Assignees</option>
                <option value="unassigned">Unassigned</option>
              </select>
              <select id="casesDateFilter" class="filter-select-inline" onchange="HubFilters.applyFilters()">
                <option value="">All Time</option>
                <option value="today">Today</option>
                <option value="7d">Last 7 Days</option>
                <option value="30d">Last 30 Days</option>
              </select>
              <select id="casesSortFilter" class="filter-select-inline" onchange="HubFilters.applyFilters()">
                <option value="created_desc">Newest First</option>
                <option value="created_asc">Oldest First</option>
                <option value="due_asc">Due Date</option>
                <option value="status_asc">Status</option>
              </select>
            </div>
            <div class="cases-filters-right">
              <span id="casesResultCount" class="cases-result-count">Loading...</span>
            </div>
          </div>

          <div class="cases-card cases-card-enhanced">
            <table class="cases-table cases-table-enhanced">
              <thead>
                <tr>
                  <th style="width: 40px;">
                    <input type="checkbox" id="selectAllCases" onclick="HubBulkActions.selectAll()">
                  </th>
                  <th class="th-customer">CUSTOMER</th>
                  <th class="th-type">TYPE</th>
                  <th class="th-status">STATUS</th>
                  <th class="th-due">DUE</th>
                  <th class="th-resolution">RESOLUTION</th>
                  <th class="th-assignee">ASSIGNEE</th>
                  <th class="th-created">CREATED</th>
                </tr>
              </thead>
              <tbody id="casesTableBody">
                <tr><td colspan="8" class="loading-spinner"><div class="spinner"></div></td></tr>
              </tbody>
            </table>
            <div id="casesPagination" class="pagination"></div>
          </div>
        </div>

        <!-- Sessions View -->
        <div id="sessionsView" style="display: none;">
          <div class="cases-card">
            <div class="cases-header">
              <h2 class="cases-title">Sessions</h2>
            </div>
            <table class="cases-table">
              <thead>
                <tr>
                  <th>Started</th>
                  <th>Customer</th>
                  <th>Order</th>
                  <th>Flow Type</th>
                  <th>Status</th>
                  <th>Recording</th>
                </tr>
              </thead>
              <tbody id="sessionsTableBody">
                <tr><td colspan="6" class="loading-spinner"><div class="spinner"></div></td></tr>
              </tbody>
            </table>
            <div id="sessionsPagination" class="pagination"></div>
          </div>
        </div>

        <!-- Events View -->
        <div id="eventsView" style="display: none;">
          <div class="cases-card">
            <div class="cases-header">
              <h2 class="cases-title">Event Log</h2>
            </div>
            <table class="cases-table">
              <thead>
                <tr>
                  <th>Session ID</th>
                  <th>Event Type</th>
                  <th>Event Name</th>
                  <th>Event Data</th>
                  <th>Created</th>
                </tr>
              </thead>
              <tbody id="eventsTableBody">
                <tr><td colspan="5" class="loading-spinner"><div class="spinner"></div></td></tr>
              </tbody>
            </table>
            <div id="eventsPagination" class="pagination"></div>
          </div>
        </div>

        <!-- Issues View -->
        <div id="issuesView" style="display: none;">
          <div class="cases-card">
            <div class="cases-header">
              <h2 class="cases-title">Issue Reports</h2>
            </div>
            <table class="cases-table">
              <thead>
                <tr>
                  <th>Report ID</th>
                  <th>Customer Email</th>
                  <th>Issue Type</th>
                  <th>Status</th>
                  <th>Created</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="issuesTableBody">
                <tr><td colspan="6" class="loading-spinner"><div class="spinner"></div></td></tr>
              </tbody>
            </table>
            <div id="issuesPagination" class="pagination"></div>
          </div>
        </div>

        <!-- Analytics View -->
        <div id="analyticsView" style="display: none;">
          <!-- Row 1: Cases Metrics -->
          <div class="stats-grid" style="margin-bottom: 20px;">
            <div class="stat-card">
              <div class="stat-label">Total Cases</div>
              <div class="stat-value" id="analyticsTotalCases">-</div>
              <div class="stat-change" id="analyticsTotalCasesSub">-</div>
            </div>
            <div class="stat-card highlight" style="background: #FEF3C7; border-color: #FCD34D;">
              <div class="stat-label">Pending Cases</div>
              <div class="stat-value" id="analyticsPendingCases">-</div>
              <div class="stat-change" id="analyticsPendingCasesSub">-</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">In Progress</div>
              <div class="stat-value" id="analyticsInProgress">-</div>
              <div class="stat-change">Being worked on</div>
            </div>
            <div class="stat-card highlight" style="background: #D1FAE5; border-color: #10B981;">
              <div class="stat-label">Completed</div>
              <div class="stat-value" id="analyticsCompletedCases">-</div>
              <div class="stat-change" id="analyticsCompletedSub">-</div>
            </div>
          </div>

          <!-- Row 2: Refunds & Sessions -->
          <div class="stats-grid" style="margin-bottom: 20px;">
            <div class="stat-card highlight" style="background: #1a365d; color: white; border: none;">
              <div class="stat-label" style="color: rgba(255,255,255,0.8);">Total Refunds</div>
              <div class="stat-value" id="analyticsTotalRefunds" style="color: white;">-</div>
              <div class="stat-change" style="color: rgba(255,255,255,0.7);">All time</div>
            </div>
            <div class="stat-card highlight" style="background: #FCE7F3; border-color: #F9A8D4;">
              <div class="stat-label">Refunds (30d)</div>
              <div class="stat-value" id="analyticsRefunds30d">-</div>
              <div class="stat-change">This month</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Avg. Refund</div>
              <div class="stat-value" id="analyticsAvgRefund">-</div>
              <div class="stat-change">Per case</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Total Sessions</div>
              <div class="stat-value" id="analyticsTotalSessions">-</div>
              <div class="stat-change" id="analyticsSessionsSub">-</div>
            </div>
          </div>

          <!-- Row 3: Performance Metrics -->
          <div class="stats-grid" style="margin-bottom: 32px;">
            <div class="stat-card">
              <div class="stat-label">Avg Resolution Time</div>
              <div class="stat-value" id="analyticsAvgResolution">-</div>
              <div class="stat-change" id="analyticsResolutionSub">-</div>
            </div>
            <div class="stat-card highlight" style="background: #D1FAE5; border-color: #10B981;">
              <div class="stat-label">SLA Compliance</div>
              <div class="stat-value" id="analyticsSLACompliance">-</div>
              <div class="stat-change" id="analyticsSLASub">-</div>
            </div>
            <div class="stat-card">
              <div class="stat-label">Active Team Members</div>
              <div class="stat-value" id="analyticsTeamMembers">-</div>
              <div class="stat-change">Last 30 days</div>
            </div>
            <div class="stat-card highlight" style="background: #FEE2E2; border-color: #FCA5A5;">
              <div class="stat-label">Root Cause Categories</div>
              <div class="stat-value" id="analyticsRootCauses">-</div>
              <div class="stat-change">Last 30 days</div>
            </div>
          </div>

          <!-- Charts Row -->
          <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 24px; margin-bottom: 32px;">
            <!-- Cases & Sessions Trend (Line Chart) -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Cases & Sessions Trend</h2>
                <select id="analyticsDateRange" style="padding: 6px 12px; border: 1px solid var(--gray-300); border-radius: 6px; font-size: 13px;">
                  <option value="14d">Last 14 Days</option>
                  <option value="30d">Last 30 Days</option>
                  <option value="90d">Last 90 Days</option>
                </select>
              </div>
              <div style="padding: 32px;">
                <div id="analyticsTrendChart" style="min-height: 350px; width: 100%;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>

            <!-- Cases by Type (Donut Chart) -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Cases by Type</h2>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsCasesByTypeChart" style="min-height: 200px;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Lists Row -->
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; margin-bottom: 32px;">
            <!-- Resolution Types -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Resolution Types</h2>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsResolutionTypes" style="max-height: 400px; overflow-y: auto;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>

            <!-- Status Distribution -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Status Distribution</h2>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsStatusDistribution" style="max-height: 400px; overflow-y: auto;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>

            <!-- Flow Types -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Flow Types</h2>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsFlowTypes" style="max-height: 400px; overflow-y: auto;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Bottom Row: Team Leaderboard, Root Causes, Resolution Time -->
          <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px;">
            <!-- Team Leaderboard -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Team Leaderboard</h2>
                <span style="font-size: 12px; color: var(--gray-500);">Last 30 days</span>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsTeamLeaderboard" style="max-height: 300px; overflow-y: auto;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>

            <!-- Root Cause Analysis -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Root Cause Analysis</h2>
                <span style="font-size: 12px; color: var(--gray-500);">Last 30 days</span>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsRootCauseAnalysis" style="max-height: 300px; overflow-y: auto;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>

            <!-- Resolution Time Distribution -->
            <div class="cases-card">
              <div class="cases-header">
                <h2 class="cases-title">Resolution Time Distribution</h2>
              </div>
              <div style="padding: 24px;">
                <div id="analyticsResolutionTimeDist" style="max-height: 300px; overflow-y: auto;">
                  <div class="loading-spinner"><div class="spinner"></div></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- SOP Links View -->
        <div id="sopView" style="display: none;">
          <div class="cases-card">
            <div class="cases-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h2 class="cases-title">SOP Links</h2>
              <button id="addSopBtn" class="btn btn-primary admin-only" onclick="HubSOP.showAddModal()" style="display: none;">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                Add SOP
              </button>
            </div>
            <!-- Category Tabs -->
            <div style="padding: 16px 24px; border-bottom: 1px solid var(--gray-200); display: flex; gap: 10px; flex-wrap: wrap;">
              <button class="sop-tab active" data-category="" onclick="HubSOP.filterByCategory('')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: #1a365d; color: white; font-size: 14px; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(30, 41, 59, 0.25);">All</button>
              <button class="sop-tab" data-category="refund" onclick="HubSOP.filterByCategory('refund')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Refunds</button>
              <button class="sop-tab" data-category="return" onclick="HubSOP.filterByCategory('return')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Returns</button>
              <button class="sop-tab" data-category="shipping" onclick="HubSOP.filterByCategory('shipping')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Shipping</button>
              <button class="sop-tab" data-category="subscription" onclick="HubSOP.filterByCategory('subscription')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Subscriptions</button>
              <button class="sop-tab" data-category="manual" onclick="HubSOP.filterByCategory('manual')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Manual</button>
            </div>
            <div id="sopList" style="padding: 24px;">
              <div class="loading-spinner"><div class="spinner"></div></div>
            </div>
          </div>
        </div>

        <!-- Email Templates View -->
        <div id="emailTemplatesView" style="display: none;">
          <div class="cases-card">
            <div class="cases-header" style="display: flex; justify-content: space-between; align-items: center;">
              <h2 class="cases-title">Email Templates</h2>
              <button id="addTemplateBtn" class="btn btn-primary admin-only" onclick="HubEmailTemplates.showAddModal()" style="display: none;">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                Add Template
              </button>
            </div>
            <!-- Category Tabs -->
            <div style="padding: 16px 24px; border-bottom: 1px solid var(--gray-200); display: flex; gap: 10px; flex-wrap: wrap;">
              <button class="template-tab active" data-category="" onclick="HubEmailTemplates.filterByCategory('')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: #1a365d; color: white; font-size: 14px; font-weight: 600; cursor: pointer; box-shadow: 0 2px 8px rgba(30, 41, 59, 0.25);">All</button>
              <button class="template-tab" data-category="refund" onclick="HubEmailTemplates.filterByCategory('refund')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Refunds</button>
              <button class="template-tab" data-category="return" onclick="HubEmailTemplates.filterByCategory('return')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Returns</button>
              <button class="template-tab" data-category="shipping" onclick="HubEmailTemplates.filterByCategory('shipping')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Shipping</button>
              <button class="template-tab" data-category="subscription" onclick="HubEmailTemplates.filterByCategory('subscription')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Subscriptions</button>
              <button class="template-tab" data-category="manual" onclick="HubEmailTemplates.filterByCategory('manual')" style="padding: 10px 20px; border: 2px solid #e5e7eb; border-radius: 24px; background: white; color: #4b5563; font-size: 14px; font-weight: 600; cursor: pointer;">Manual</button>
            </div>
            <div id="emailTemplatesList" style="padding: 24px;">
              <div class="loading-spinner"><div class="spinner"></div></div>
            </div>
          </div>
        </div>

        <!-- Case Detail View (Full Page) -->
        <div id="caseDetailView" style="display: none;">
          <div id="caseDetailContent">
            <div class="loading-spinner"><div class="spinner"></div></div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // Will add JavaScript in next step
    console.log('Resolution Hub loaded');

    // Simple navigation - handle clicks on nav links
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', (e) => {
        e.preventDefault(); // Prevent default link behavior
        const page = item.dataset.page;
        const filter = item.dataset.filter;
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto(page, filter);
        }
      });
    });

    // Simple URL parsing on page load
    function initFromURL() {
      const path = window.location.pathname;
      
      // Parse /hub/cases/shipping -> page: cases, filter: shipping
      if (path.startsWith('/hub/cases/')) {
        const filter = path.split('/hub/cases/')[1].split('/')[0];
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('cases', filter);
        }
      } else if (path === '/hub/cases' || path === '/hub/cases/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('cases', 'all');
        }
      } else if (path === '/hub/sessions' || path === '/hub/sessions/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('sessions');
        }
      } else if (path === '/hub/events' || path === '/hub/events/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('events');
        }
      } else if (path === '/hub/issues' || path === '/hub/issues/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('issues');
        }
      } else if (path === '/hub/analytics' || path === '/hub/analytics/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('analytics');
        }
      } else if (path === '/hub/sop' || path === '/hub/sop/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('sop');
        }
      } else if (path === '/hub/email-templates' || path === '/hub/email-templates/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('email-templates');
        }
      } else if (path.startsWith('/hub/case/')) {
        const caseId = path.split('/hub/case/')[1].split('/')[0];
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('case-detail', caseId);
        }
      } else if (path === '/hub' || path === '/hub/') {
        if (typeof HubNavigation !== 'undefined' && HubNavigation.goto) {
          HubNavigation.goto('dashboard');
        }
      }
    }

    // Handle browser back/forward buttons
    window.addEventListener('popstate', () => {
      initFromURL();
    });

    // Initialize from URL when page loads (after hub-app.js is loaded)
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        setTimeout(initFromURL, 100); // Wait for hub-app.js to load
      });
    } else {
      setTimeout(initFromURL, 100);
    }

    function refreshData() {
      console.log('Refreshing data...');
      // Will implement
    }

    function handleLogout() {
      // Will implement logout
      console.log('Logout clicked');
    }
  </script>
  <script src="/hub/hub-app.js"></script>
  <script>
    // Cache busting - add timestamp to force reload on every page load
    (function() {
      const timestamp = Date.now();
      const scripts = document.querySelectorAll('script[src*="hub-app.js"]');
      scripts.forEach(el => {
        const url = new URL(el.src, window.location.href);
        url.searchParams.set('v', timestamp);
        el.src = url.pathname + url.search;
      });
    })();
  </script>
</body>
</html>
